import { exec } from "./base.js";

const testinput = `[1,1,3,1,1]
[1,1,5,1,1]

[[1],[2,3,4]]
[[1],4]

[9]
[[8,7,6]]

[[4,4],4,4]
[[4,4],4,4,4]

[7,7,7,7]
[7,7,7]

[]
[3]

[[[]]]
[[]]

[1,[2,[3,[4,[5,6,7]]]],8,9]
[1,[2,[3,[4,[5,6,0]]]],8,9]`;

const rawinput = `[[[0,10]],[7,9,[[2,1],[7]],4,[[5,0,5,7,8],0,0,[10,3,3,2]]],[[1,[3,8,8,6,8],6,[1,3,7,9],[9,1,1,7]],[],[[1,0,4,10],8,5]],[]]
[[10,3,[[4],0,8]],[7,6,[]]]

[[[5,[10,4,3,10,1]],1],[[[3,1,4,6,2],[3,9,3,9],[0,0],[8,10,2,6,6],9]],[10,[[]],5,5],[8,[9,2,4,7]],[4,4]]
[[[[]],[[8],[],[5,1]],4,1]]

[[8,9,[[],8,10]],[[4,[0,7,9,5,5],[8,3,4,6],9,6],4,[7,[2,1,7,4,10]],3,4],[7,4,[[3],5,[0,9]],10],[4,[],4],[2,2]]
[[3,[8,[1,8,3],[0,10],7],[[8,6,2],[10,7,6,7],4,[1,9,4,6,9]],[[10,5,10],4,[4,1,2,2,8]],[4]],[],[6,6,[[7,6],[5,6,7,5,7]]],[[[0,1,5],0,0,6],[]],[]]

[[0,7,[]],[],[[],[6,3,[4,8,4,2,1]],[[5,8,9],[],[4,10,1],[],6],3],[8],[5]]
[[0,3],[0,9]]

[[],[8,[],5],[]]
[[9]]

[[],[[10,[10],[8,3,3,5,1],[4]]],[5,5],[],[[[3,9,1],7,5,5],8,[[],[0,7,7,2],2]]]
[[6,8],[[],2,[[],10,6,[8,4],9]],[[],7,[[0,0,3]],4,9],[5,[],[[2,3,5,10],7,[2],[0,2],[7,10]],7,[[7],4,[5,2,10],10]],[[[1,2,5,1,0],[10,0]],[[7,6,8,6],[],3,6],[[6,2,2,4],5,[8,4,3,6,5],4,[3,0,8]],[],0]]

[[9,0,[[9],1,7,[3,8,0,1]]],[[],[1,[0,8,10]],7,6],[7,10,[1]],[[[8,4],0],1],[5,[[],6,[6,9,8]]]]
[[[[],3,[0,1,6,0]]],[1,[[6],10]],[[[],1,[2,8]]],[[[10,9,10,2],[1,2,10],[9,7,7,6,5],[5,9,2,4]],[[5,10]]]]

[[],[1,3],[9,[[1]],5,5],[[[4],[2],7],8],[[[],[2,6],[9,3,4,8,6],2,[9,8,7,9,8]],10]]
[[7,[3],[[3,0],[4,0,0,5,5],[10,7,2,10],5,[2,4]]],[[5,1,2,9],[[8,4],[3]],9],[]]

[[10,[]]]
[[[4],[3,4,2]],[3,[[],[6,5],6,4,[8,4,5]],[],[3,[],4,[0]],3],[7,[[0]],[[],[5,9,5],4,[2,3]]]]

[[10,2,4],[],[]]
[[4,[7,0,9]]]

[[[6,8],4,[]],[[[7,4,6],[1],[0,1,0],[],3],[2],6,[[2,10],4],4],[[8,[0,1,5,10,1],8],10]]
[[8,[4,8,[2,9,3]]]]

[[4,1,4],[[[3],8],0],[],[],[[[2,3,0],0],8]]
[[5,8,4,[6],4],[7,[[4,5,2,8],4,[9,1],9,9]],[]]

[[7,3],[2,[],[],[5,8,[],[]]]]
[[1,[2,[],9,[2,9,3]]]]

[[8,2,5,5,7]]
[[],[10,5,6],[7,[],0],[9,[[7,9],[5,4,10],[9,8],1,3],7,10,[]]]

[[2,7],[],[6,[5,1,[2,5,1],[6,7,3,4,4],9]],[0,[1,6,[5,3,1],[5,3,8],5],7]]
[[[],[]],[]]

[[[3,[4,1],8,10],[[2,7,6,0]],5,0],[7,[[2,5,7],[0,8,8],[]],0,9],[[3,[3,7,2,1]],0,[10],3,[]],[]]
[[8,[1],8,0],[9,[[10,1,9],[],0,[8,5,7,0,0]],0,[1,[6],6]],[[1],[1,[]],[8,4,[8,5,6,4,7],[9,2],8],2,[0,[9,2,7]]],[[9,[4,1,8,7,0],5],6,8,0,2],[[2,0],10,[[4,6,2,0]],[[]],[[]]]]

[[[[10],[],[],[0,4,8,0]],4,1,1],[[[2,3],[],[7,7,2,10],2]],[1,10],[[[6,10,7,6,2],[0]],4,5,[1,5,[6],5,[10]],[7,[3],0]]]
[[[],[3,1,[7],3],[[7,8,7,1,10],[7],2],3,[7,4]],[10,[9],3,[8,[8,5,10,2,8]],2],[[[5,2,10]]]]

[[10,[1,[5,3],[4],3,0],[[3,2,1,0,0],[]]]]
[[5,5],[0,8]]

[[[]],[[8,[8]],[[],[2,8,10],[7,5,10,0,3]]],[[[1],[5]],2,[[9,5,8,2,0],2,7,6],[[8,5,0,3,8],[9,1,3,7],[5,7,7,8,3],[]]],[[1,0,[5,6,8,2],6],[9,1,[4,7,7,5],3,[]],[6,0,[8],4]],[[3,10,[6,10,7],8]]]
[[0,7],[0,1,[8,[9],[4,10]],[[8,7,3,2,9],4,7,[],6]],[[[5,8],[1,5,5]],7,9,6],[],[8,[[8,0,2,6],1,[],3],3,1,5]]

[[[],[5]],[3,6,[],5],[[[2,7,5,0],[0,7]]],[[10,10,[1]]]]
[[0,[5,8,[10,2,9,0,1],[3,1,7],7],[[6],2],5]]

[[[[9,4,9,10,5],7,2],8,0,[]],[],[9,7]]
[[8,[2,[9,0,9,0],2,[6,10,8,10,5],8],1,9,6],[4,9],[0,4,7,[0],[1,[7,1],[],5]]]

[[4,[],7],[]]
[[[4,5],[[5,1],4,[],0,[9,9]],2,7,3]]

[[[[6,7,2]],[3,9],5,[[1],[0],[6],[7],[]]],[[2]],[10,[8,[6,3,5],2],1]]
[[[[6,5,6,9],10],[7,2,2,7,[7,6,10]],9,3],[6,[3,5,8,[10,4,6,1,1],2]]]

[[[10,[2,10]]],[[[6,3,5,8]],[[10,2,10,1],9,5,7]],[]]
[[1,0,[[7,1,8,1],6],3]]

[[],[],[1,[9,6,4,7],4,[]],[[],0,3,[[2,10,9,2],2,7,[],[1]],[2,[],8,8]]]
[[7,3],[],[2,8,[[],7,[8,7],[8,1,2]],8],[]]

[[],[],[[[],[1],3,[10,6,0,8],[10,4,6,9,0]],[],1,1]]
[[6,10,0]]

[[10,[5,[3,0,1,2],[5],2],[[3,1,0,2,7],5],5],[8,[[10,7]],[[10,2,10,10,8],[]]],[3,[6],5,[[6,10],[6,2,5,9,4]]]]
[[[1,[1,3,1],0,[4]],[],8],[[5],[[7,8,9],[],[]]],[[5,[1,6,6,1,0]],6,6,[[10,10,8,3],[9,8,7],[10,0,2,5,3]],4]]

[[[],7],[[[3,0,8,8,2],7,9,8]]]
[[[1],[7,3,[8,4,2,7,3],[0,1],10],1]]

[[8],[9,[4,[5,1],[6,6,9,7],2,[4,7]],2],[9,6]]
[[[[2,10],2],4,7],[[7,[],[10,7,10,6,4],[3,2,7,9]],0,6,[4,1,[4]]],[[6,1,10,4]]]

[[[[1],[3,8,3,1]],[0,[1,1],0],3],[],[],[[[]],[],[[0,7,0,0,1]],[]],[7,[9,10,[3,4,6,4,8]],[3,7]]]
[[[2],10,6,[2,2,[4]],[1,[4,9,8],2]],[[8],1],[4,10],[10,[8,[]],3,8,[]]]

[[[[4]],[5],[[2,9,0],8],[]],[[],4,3,[[2,3,6]],[[2],3,[],[9,0],[9,7,1]]],[[10,[]],[],5,[[3],[4,4,8,8,2],[0,6,6,10]]]]
[[[[4,8,0,9]],[1,1],2,8,[[10,5],[4,7,7,7]]],[[9,10,8],[],[[0,2,10,0,6]]],[2],[]]

[[6,8]]
[[9,9,[[9,8,4],[6,1,1,7],8]]]

[[],[[0],7,[[5,10],3,[],10,[]],2],[4]]
[[],[7],[[9,7,9,8,4],6,9,1,[]],[[10,[9,2,7,6],[2]]],[[2,[6,2,0,8,3],[3],[6,10,7]],[2],5]]

[[6,3,[7,3,3,4,4],[],[10,0,3,7,6]],[7,[[2,3,10,3,0],[],0,3,9],[[4],6],0,2],[]]
[[10,0,[[9,1,5],4,10,[2,3]],2,[]],[]]

[[[[10,1,5,4],9,[6],[10]]],[[[6,7],5,[4]]]]
[[7,[0,[]],6,3,10],[[7,0],9],[10,[1],[3,[],3,1]]]

[[0,0,3,[],[3]],[],[10,[2],[[5],4],[[6,0],8,5,[]]],[]]
[[],[[[4,5]]],[]]

[[[[3,0,4,3,2],7]],[4,10,1,[7,2,5,7,3],2],[],[[5,[8,1,2],[6],[0,6,6,5],[4,9,4,5,8]],7,0,9],[]]
[[[[7,10]],[[10,0],[1,9],1,3]],[2],[[2],5],[[4,[],6,9]]]

[[[0]],[],[[[],[5,1,6,10]],[],[1],2],[0,[3,1,1],8]]
[[[1,[4],1],3,[9],2],[],[1,[],[],1,[10,5,0,[]]],[[[10,3,5,2,6],8,10,[10,4,10,10]]]]

[[1,[2,[10,8,2,1,1]],0]]
[[[1]],[[[2,4,10,2],[]],3,8],[9,3,[5,[3,0],[0],[4]],6,[[9,8,3,7],4,[10,10,8],10,[6,6]]],[[[3],7,[],[10,5]],0],[5,[[3,9,0,2,1],0,[4,5,2],[6]]]]

[[[]],[[[8,9,10,8],[6,5,4,10,10],[8,10,0,2,0],[1,7,1],[]],[[]],7]]
[[],[],[8,10]]

[[],[8],[]]
[[[10],[0,[]],[3,[]],[[5,6,2,0]],3]]

[[5,7,1,3]]
[[[],[[],[4]],5,[7,[8,5]]],[[],8],[7],[9,[],1,[[7,1,6,7,10],[7,4,6],[10],7,[10,5,4,6,4]],6]]

[[2,[[0,6,1],2,[4],5],[8,[0,4,0,0]],10]]
[[[],[],10,6,[6,[3,6,2]]],[[10,10,[10,0],[3,6,2]],6],[[[5],5,1,[10,6,10,10,10]],9],[[2,0,[6,1,6]],[]],[[5,[3,0,0,6],0,7,[6,5,10,7]],3,[[0],6,[2,8,2,8],[7,2,5,8,0],8]]]

[[[5,[4,2,2,1],[0],[2,3,6,6]],2],[[1,3,1,6,[2,4,3,4,6]],2,2],[4,3,1,2],[[],[9,[5],1,9]],[[],0,5]]
[[],[]]

[[[10,4],[],0,2],[3,9],[]]
[[[],[10,[3,5,10],[2,9],6,[8,4,7,5]],[[5,8,9,2],[0],[7]],6,6],[],[3,[[5,7,8,7,1]],5],[]]

[[[0,0,[0,4,3,9,3],7,8]],[],[[[6,3,9],5,1,[7,4],7]],[6,9],[[[3,2],8,[3,0]]]]
[[5,1,[],[4,9,[],[0,5,7,6]],6],[4,[5,0,[],7],[],[0,[1,6,6,2,2],[8,1,0]]],[7,7,8,6],[0,3,7,[],0]]

[[],[[[0,1,10,0,2],[],[],10,[1,8,4,7]],2]]
[[[5]],[9,8,[[],0,[1,9,4,5],1,2]],[4],[4],[]]

[[6,[[8,0,6,1]],4,6,4],[7],[3]]
[[[[3,8],[10,2],10],[],[6,1]],[[10,[9,8],[5],[6]]],[[0,4,4,9],[3],9,4],[2,5,9,[6]],[[[],[7,6,0,7],[4,6,2,1]]]]

[[[2,[5,4,2],[8,10,9,7],[8,1,4]],[6,10,[3,1,10]],[[],[1,7,1,4,4],[8,4],[]]],[[[3,3,9,6],[0,3,9],1,[7,9,1,7]],[]]]
[[3,[[7,0,5,8],[],[7],3,[9,1,0,10]]]]

[[[9,9,1],[7],[1,8,[9,3,10,3],[2]]]]
[[[[4,5]],1,[8,[4,5,6,9]],[6,4,[4,4],[]],[8,6,2]],[1],[]]

[[[],1,[[9,2,5,2],2]],[[6,3,[10,9,2,9],3],[1,4,[3],3],3],[9,5]]
[[[0,3,3,0,[5,3,8,10,9]]],[[],[],3],[[[5],1,[4,6,7],[6]],6,[[2,5],6,7,7,0]]]

[[[],1,[5,[6,5,9,8],7,2,[6,10,5]],[[],4,9]],[[10]]]
[[[7,4,[7,6,0,3]],0,9,10,6],[[],[0,[],[0],10,[0,5,4,0,7]]]]

[[[[6]],[],[],[[],1,[2,0,9,6]],[[1,9],0]],[]]
[[],[],[[8],3],[10,2,[],[]],[[],[[]],5]]

[[8,2],[[[7,4,2,8],10,10,6,6]],[],[[[6,7],[5,4,0,6,3]],[],9,0]]
[[[1,[]],6],[7,[[0,3,4,4,5],[8,0,6,10],0,[5],0],10,[[1],9],[]],[2]]

[[[]],[[7,6,[5,10,5,3,7],8],[0,[0,8,10,4],[2,3],[8,1,2,9,4],9],[],0,[[2,1,10,2,0],[8,4,10,0],[0,1],3]]]
[[2,[[1,5,9,4],7],10,1,9]]

[[4,[3,5,[8],5],[[0]],[],6],[6,[[7,2],7,[10,5,9]],5,[7]]]
[[[6],[8,[6,6]],6],[],[[6,4,5],[6,3],[1,2,[0,9],1,0],5],[[[2,3,2,0,5]],[[8,2],[2,8,10,6]],6,[[7,5,9,5,4]]],[]]

[[10],[[],[[2],5,[2,5,3],[],[6]],1,9,9]]
[[[[4,3,5]],[[4,8],[0,7,4,10]],[[4]],4],[4,[[9,4,10,5,2],[]]],[0],[]]

[[8,[9],3,[5]],[],[[9,[],8,4,4]],[[[10]],[[],4,[5,9,10,8]],4,[1,4,[10,5,4,3,9],[3,2],[0,0,4,4]],1],[[[4,4,6,2,6],[9,4,4],[],[9,2,2,2]],9,[]]]
[[9,[4,[3],4,[8,5,1]],[[2,6,1]]],[],[[1,3,5,6],8,10,[[1,6,0,6],[1,5,1,7,6],5,4,9],8],[[[7,8],[9,6,8,9,9],3],2,6],[6,5,[[4,3,8],6,[2,9,3,9],[]],9]]

[[[],1],[[[0,0],[2,5,0],8,[10],10],[[7,7],[],4]],[[[10,2],[],10,9],[9,8,2],0],[]]
[[],[0,9],[[]],[]]

[[[[10,7],7],[4,[4,4,4,0,9],[],4,[8,3,2,7]],[],[[7,7,7,9,2],[2]]],[[]],[2,2,0,7],[[[9]],4,1,1],[[1,9,[0,4],[0,7]],3,6,5]]
[[],[],[[7,1,2]]]

[10,7,10,9,7]
[10,7,10,9]

[[],[4,[],3,[10],[4,6,8,[10,1]]]]
[[7,[[5,5],7,[],9]],[],[]]

[[],[[0,2,9,[3],5],7,[[4,8,0,0],5,1,1,6]]]
[[[1,3,[3,5,5,4,5],[1],[9,8,4,9]],2]]

[[],[6,[4,9,6,[6,9,10,5],10],[5,1,2],[0,[]]],[[[0,1]],[7],9,4],[[4,[8,3,6,9]]]]
[[[[0,2,5,5],[10,7,6,9,3],5],[[0]],6,[[3,0,1,8],[10,0,8,10],[8,10,4,6,10],8,[3,9]],0]]

[[8,[[1,6,8,4],[],[5,0],8],9],[3,6],[[5,6,6,7],5,3,9,[]],[9,5,9],[3,[8,0],[[2,9,5,7],[0,4,4],6,[9,5,10,6,6]]]]
[[[1,[]]],[2]]

[[3,[8,[7,4,1,6],9,[4,5,9,3,4]]],[[[5],5],10]]
[[1,[],[[4,3,0,3,4],[3,9,4,0]],[1,[1,6,10],10,[10,10,7,6]],[[4,0,3,3],[2,1,3],6,[6,10,3,8,4]]]]

[[[4,10,[5,6,4]],[[7,5,5,6,4],[],1,1],3,[5]]]
[[[1,[10,8],1,5,8],2,[[3,5,3]],8,5],[[[],[2]],0],[10,[[0,3,1,9],6,8,3,[1]],1,[5,4,[6,8,10],9]],[1,[9,3],8,5],[[[1,3,7]],[5,7]]]

[[[3],[2],6,[[1,6,4,7,8],[4,3,4,3,4],[0]],2],[[7],6,9,0,[[1,4,3,1]]],[2,1,[9,[4],[]]],[[[5,10],[7,2,6,5],[4,4,9,7,6],[8,8,6,7,1],[]],[],3,[],[[2,3,2],7]]]
[[6,[]],[0,7,10],[[6,[0,0,4,7],[5,3,6],[0,8,3,5,8]],[[],1,[10,0,3,8]]],[7,[[],1],[9,[10,6]],[[1,3,8,0],[6,0,7,10,5],[3,9],[0,2],1]],[10,4,[1,2,0,5,[10,10,8,9,7]],[10,[9,7],[6]]]]

[[1,[8,[3,0,7,4],4,[]]],[],[[],[[1,10,1,9,10],[10],[],10],[2,[10,6,1,1,7],6],[],5]]
[[10,3,8,[6,[8]],[[]]],[2,2,[3]]]

[[],[[2,[7,5],[0,2],3,9],[[7,3],[5,0,7]],[0,[1,3,5,5,6],10],7],[4,5,[3],[3,10,6,[10,1]],9],[6],[[8,[7]],5,5]]
[[[[5],8,3],6,1,4],[[[3],[9]],[9,[2],[0,0,9,9,2]]]]

[[0,[6],[7,5,0,[1,8,0,7,6],10],[4,10,[6,5],9],[5,[],[10,6,9,5],[9,1,5,10]]],[[[10,0,0,4,2],4,6],[[0,5,10,7,2],[],[4,0],6],[10],7],[[6],5,2,10],[[[1],[7],[2,0,1,2],[8,10,4,1],[2,8,8]],[1,0],3,[5,10,[6,10,6,6]]]]
[[[10,1,[],[10,9,1,8,3],[10,10]]],[2],[6,[9,[2,10,8,0],10,0]],[[1,6],[4,10,[7,4,6],[7,6,7]]]]

[[7,10,[10,[4],[1,1],10],7,[2,[7],[8,9,3,0,8],[6,4,4,3],[6,6,5]]],[[3,1,2],10,[5,9,[3,6,6,7,5],2,[4,2,3,8,9]],[2,[1,3]],0],[[5,9,9,[8,5,8],[2,4,8,9,7]],9,[]],[[1,[],0,1,4],9,[],[8,8,[10,9,9]],[7,5,[4]]]]
[[[],[[8,4]],[[1,3,0,10],[2]]],[3,1],[[[],[8,1,8],[4,3,7],[10,0,10,2,0]]],[8]]

[[0],[[],[[9,10,2,5,2],[],[10,4]],8,[9,6,[7],[],[7,0,1,1,9]]],[[1,8,7]],[10,[4,[0,7,7,7,2],4,[9]],[[4,0,7,1],0,[4,0],3,10],[]]]
[[3,1,[[8,1,0,3]]],[[0,1]],[[[4],2]]]

[[2,[[3],0]],[],[[],[],4,6,7],[[],2,[1,5],3]]
[[[[4,2,8],1],[[9,9,3,7],[2,6,5,6],4,1,[10,7,7,6]],5],[]]

[[[5,[6,8,8,1]],6,9,[0],5],[[[6,5,6],[5,1,9]],0,[5],[[3,4,6,8],9,[7],5,[8,1]],7],[[1],[],[]],[5,[[5,5,4,3,6],8,0,[1,7,8],[1,6]],[],[[4,7,2,7],[7,0,4,9,9]],[2,[8,3,4]]],[[[5,8,1,9],[0,7],3],[0],8,[[8],4,4,[10,6,2],[8,5,5,7,3]],3]]
[[[4,[0,8,10],[7,10,2,8],[],0],7,[[3,2,3],[9,6,0],8,[],10]],[[6,[3],[]],[1,[1,9,9],[4,5,9,1],[]],[2,6],[[8],[6],3,[6],[10,3]],[0,[0,4,3,3],[1,3],10]],[7,9]]

[[[9,[6],3,[],[0]]],[[[7,6,9,8],7],[1]],[[[8],6,[0,1,7],0],[9,10,4],[[6,3,3,1,6]],8,8],[5,[[4,2,9,3]]]]
[[],[2,3,4],[8,[7,[],3],[[2,10,5,10]]]]

[[],[[[],5,[0,3,0,4,5]]],[[7],[],[6,[],[1,10,7,4]]]]
[[[[],[4,7,3,0],[10,4,1],0],9,[7,[10,4,7,4],4]],[10,[[0,3,9,8],[10,4,8],6,[7,6,8,3,5]],[1,10],[[]]]]

[[6,[1,[7,10,4]]],[[[9,4,0],3],[],9,6],[10,[[0,9,1]]],[9],[]]
[[[[8],[5],[8,9],[8],10]],[[8,0,1,5],7],[5,4,[8,[1,1,7]]]]

[[],[3,8,0],[[[3,1,10,1,9],8],2,[],10,10],[2,[1,2],2]]
[[1,[]],[[4,2],9,[5,8,7,9],[2]],[10,[],6,[10,[]]],[[[9,10,0],2,6,2],7],[[10,1,[1,2]],[3],2,[6]]]

[[[],[],6,10,[8,6,[7,0,7],[0,1,0,8],[6,6]]]]
[[1,0,2,[7,2]],[[1,[10,6,1],0,2],[10,[9,9,8,6],10,[6,2,8,1]]],[[[1,0,3,1],4,2,3],[[8,7],1],1,[[],[3,4,5],[]],[[6,5,3,10],[8]]],[2],[0,3]]

[[6,[[],1,8]],[4]]
[[1],[],[4,[[5,10,2,3,4],[3,2,10,0,2],[]],[[],[]],[]],[[],[[0,6,9,6,5]],[]]]

[[0],[[[3,1,6],4,7,0,8],[6,[9,9,10],[1,1]],[9],6],[]]
[[[],[]],[2,0],[4,8,2],[[[0,3,6]]]]

[[[[1],[9],2,[5,10,8,3],4],9],[[],[[1,6,8,9],2,[5,5,7],[0],8],[[1,6],[10]],[7,[]]],[],[5],[2,[],[2,[10,3,2,8],[3,8],[]]]]
[[[8,7,[7],[9]],5,5,0],[[[5,0],[],1,10],[0,[10,6,8,2],[8,6,5,8],3],6],[[[],[4,6,8],[9,3,2,2]]],[],[8,[],[10,7,8],9]]

[[2,4,6,[[8,4],[3,7,10,10,9]],[[],9,[],[2,8,10,1,5],6]],[[[10,8,10,10,7],8,6,[7,4,3,9]],[]],[1,[2,[9,3,7,9,8]],7],[0,0,[[1],[10,10]]]]
[[[[1,2],[0],[0,1,5,6,3]],[[7,1,8],[4],6,[4,10,1,7],[7,1,6,3]]]]

[[[[6,9,1,10],[10,10,4,7]],9,9,[3],7],[]]
[[[10,[8],10,1],[[8,2,6,8],[6,3,2],0,3]],[[[5,10],[9],6],[[5,5,3],[],[10,0,4],2],[[],10,4,8],[],6],[10,[],0,[[],[2]],[7,8,2,[5,0,10]]],[5,[4,[6,0],[0,2,8,3],4,[4,9,4]],2,[[6,2],[3,2,0,3],[],8,10]]]

[[],[8],[8,3],[]]
[[],[2,[4,3,6]],[8]]

[[5,[7,0,[6],9],4],[[[1,7,2],[4,4,1,10,9],[8,2,0,7],9]],[[[6,3,1,3],[7,7,4,7],[],[1],10],8],[[],[1,6],6]]
[[],[10,3,7,3,[1]],[[3,9,[9,7,5,7]],3,[0,[0],4],4,[8]],[0]]

[[8,[],5],[[[4,6,0,3,7],2],10]]
[[[[8,4],8,[1,8,0,4,7]],[[1,8,3,7,8]],[0,4,[7,9,8,5,5]]],[[7],[3,[0,6],1,7,[9,6,1]]],[6,2],[0,9,[[7,8,2,4],4,3,8,5],6]]

[[10,[3,[4,0,8,3],[2],[5,6]]],[6,[4,[6,3],5,[8,10,7]],[[],[5]]]]
[[[[],[3]],0,[],5]]

[[],[5,10]]
[[8,[[1,9,3,8],2],[[5,3,3,4,4],[3,4,9],[8,3,6,2,6],4],0,5],[1,1,[[8,2,5]]],[2,[[5,8,0,1],8,10,[1,5,5,2]],[[],[]],[]]]

[[[8,[1,2,9,8],4]],[[[9,3,1,7,7],5,[6,7,5]],6,[[1,0,10,5,2]]],[2,[5,9,5]]]
[[10],[5],[2]]

[[8,[2,[1,3],8],[4]],[6,[[1,8,1,10,8],2,[9,7],[]],9,7],[3,[4]]]
[[[[9],[5,4,10,3],[3,4,7,2],[7]],4,4,8,4],[9,4,[[2,7,5,3]],[2,1,5],2],[],[[5,9]]]

[[[],10],[3,[[4,6,10],[7,9],10,5,0],[0,7,[],0,[1,2,6]],[0],1]]
[[[[7,8,6,9,3],3,[1]]]]

[[[[2,0,2,2],[7,5,3,0],[5,7,1,9]],6,9],[10,1,[[6,7,0,5,9],2,3],[]],[[[10,10,8,8],[],[],[2,4],[6,6,3,3]]],[8,[[4,2,3,7],5,0],[10,2],[[7],[10,8,0],0],0]]
[[[[2,10],2,[0,7,1],6],4,[[6],6,[2,9,2]]],[[[1,4,8],9,[1,0,6],[8,9,0,10,2],7],8,[[7,4,4],[10,1,6,1],5,10],5],[[],6,[[7,1],4],5],[[[2,1,4,9],[5],[8,8],[0,3,9,0,3],[9,0]],4,[1,[9,10,1],[],[3,1,3],[6,8,3,9]],6,1],[[[1],[6,5,10]],[3,0,[3,2,10],2]]]

[[[[0,8,1,10,10]]],[10,[]],[[7,[3,9,5],[2,7,0],0]],[],[]]
[[],[0,9,3,7],[],[2,8]]

[[10,2,6],[[[9,7,10,6,2],7,[3,7,2]],3,3,[0,[1,1,0,9]],0],[8,5],[[6,[],4,6]]]
[[[8,[],2,[],[6,4,8,1]],[6,7,4,[0,6],7],[],6,[9]]]

[[[[0],[10],10]],[2,[[5],0,[7,3],6],[[4,9],7,4,[]],[[3,2,4,0],[],[],[3,4,7,7,1],[7,9]]],[],[[]],[[[],10,[],9],7,1]]
[[[[3,4]],1,2,[3,[9],1,5,[3]]],[[4,[10,6,4]],10,[[7,0,3,10],9,2,[8,10,3],10],[7,3,[7,3,4],0,10],[[],[0,3],2]],[],[2,[[7,3,4],[],3,[6,1,0],2]],[[],9,[[4,8],[3,10,0]],2]]

[[6,2,8,[[],7]],[],[[1],[[3,6],9,[],[6,7,8,1]],8,[[2],[0,9],9,5]],[]]
[[[[7,7],[]],[],6],[[10,0,3,[9,6,2,4,8],[]],10,3,[[1],[7,5,8],0,[9,10,2],[0]]],[8,[[9]],1],[5,[4,2,5],9]]

[[[6,[4,5,9],7,2],6],[4,2,[[9],[],[],[0,9]],2,[[0,5,4,0],6]],[],[9,3,[1],7,[2,[],4,0,3]]]
[[8,1,[6]],[[7,7,3,[1]],1,[2,8,10,8,3],5],[[[1,9,9],2],[[7,8,6,9,5],[7,6,1],[2]],5],[3,[5,3,[10]]]]

[[],[3,[[],6,[3,8,1],2,5],3,[[0,0,5],10,[]]],[]]
[[],[[],3],[[],[]],[[[7,8,9,1],2],[[0,1,10,3,8],7]],[[[0],[],[],[4,10,3,6]],[],10,[1,[],10,[9,5,3]]]]

[[],[3,[[],[0,8,1]]],[[[9,5,5],9,[10],[4],[9,1]]]]
[[6,[[5,5,3,0],[2,7,5,5,4]]],[[8,[0,7,5,6],[7]]]]

[[[5],7,[3,9,[8,0,10]]],[],[7,5],[5]]
[[[],[],4],[0,10,[[4,4,5,6,5]],3,3]]

[[3]]
[[1,[2,8,2,4],[8,[],[8,3,9]]],[[0,[0,10,3,4,4],7,6,[]],[],9],[[7,9],[[]],1,10]]

[[[[7],0],10,5,2,4],[[10,[],2],[[5,2],0,[10,6,5]],1,9]]
[[5,7,[[10,8,2,10,8],[8,6],8,[5,1,4,5]],[],[10,[1,9]]],[[2,[5,3,2,10,6],[5,2,0,3],[6,10]],[[5,5,1,5],5,[9,3,10,6]]],[[0],7,3,[[],[],8,1,3],[10,[2,8],4,4,2]],[6],[4,3,4,[8],5]]

[[[[2,6]],0,0]]
[[[0],9,1,7]]

[[8,2,10,3,2],[7,2],[[[4,9,8,3],[],[10,3],1],5,[5,[3],[4,9,4],[2,6,6,2],[5,4,10,3]]]]
[[0,6,[3,[]]]]

[[[[7,10],7],8,[],10,8],[3],[],[9,4],[[[10,5],[7,2],[6,3,8,5,8]],8,6,3]]
[[4,0,[[10],[7],[],10,3]],[],[[[6,7],5,9,[3,3,4]],3,[],[4,10,6,2],4],[[2],[[7],[3],[3,2,10,9]],[2,6]]]

[[[[9,0,2,9,6],[9],[10,3],6,[1,10,5]],[[4],5,[4,9,6,7,4]]],[[]],[1,5,[]],[5,7,9,[[],[],7],[[8,7],[0,8,4],[6,6,4,7]]],[[4,[],1],2]]
[[3,[[8,7,3,4,7],[7],[9,6,0,2]],[4,8,[0,0,5,5],[]]],[],[7,[[0,10,2,9,2],[10],[0,1,7,9,4],10,[6,7,8,4,8]]],[]]

[[],[3]]
[[],[],[[[1],[8,8,10,9],[1,7,6]],7,[[7,5,8]],[[8,5,7,0],5,[6]]]]

[[5,8],[7,5,9,10,[[8,7],8,[],4,[2]]]]
[[],[[10,8,6,[6,9],[7,7]],[9,[5,5],2],5,[[10]]],[]]

[[[[],[1,2]],[[],[9,5,5],7,8],0,3],[4,[3,1],0]]
[[10,[[8,3,9],10]]]

[[[[4,10,3,8],7,9],[],[2,1,[5,0],[4,10],3],5],[8,[[3],2,9,6],6],[],[[],[6,3,[9,10,5,8,10],5,[10,4]]]]
[[[[],7,3]],[],[[10,[10,4],10],3]]

[[[[7,6],[5,6,0,5,2],[7],1,8],6,[[10]]],[],[1,7,6,1,5],[0,[[0,5],3,[1,4],[],7],[[9,0,3]],[[9]],[[1]]]]
[[4,[],[],[5]],[[[],[1,3,0],[10,3,5,2],2,[4,2,0,8,9]],[0,[4],[],[2,3,3]],9],[3,[1],10,5],[[],[7,5,[10,9,7],3,[]],10,[8,[]]]]

[[8],[[8,[4,3],0,[2,4,10]],4,8,8],[[[2,1],9,[],[7,3,5,3,8]],6,9,10]]
[[[[0,4,0,6]],5,[10],[[4,4,9,9],[1],[2,4,0,0]]]]

[7,7,7,8]
[7,7,7,8,9]

[[[[7],[2,5],[4,1,10,9]],[[],[6,0,2,1],[0],[7,0],9],8,[6],9],[4,[],[]],[2]]
[[7],[[6,6]]]

[[10,0],[6,2,10],[[[9],7,[6,7,9,1],9,[5]],[6,3,4],[],[[7,1,4,3,9],7,[5,3]],4]]
[[8,[],6,[7,[],[9],[8,9,5,0]]]]

[[0,[5,[4,1,0,4,8],[7,5,0,4]]],[8,2],[]]
[[[[7,4,0,6],2],[[1,0,5],5,6],[6,9,7,7,1],8],[9,[[7,3,0,10],[3,10,1,7,0],[7,9],[],[4,2]]],[2,6]]

[[1,5,0],[1,[]]]
[[],[[2]]]

[[1,2],[0,[[5,9,5,0,0],10,3],7,[[10,5,5],[10,6,9,3,10],0]],[[[9,1,10],5,[0,7,5,2,10],[0,1,2,5],[2,2,6,2,9]],6,[[6,10,1,1,5],[6],4,6],1,7]]
[[[[4,4,7]],2,[[],[0,8,3],1,7,[]],2,[2,8,[],[1],5]]]

[[[],4,[7,[8,0,6,0],[1,2,6,5],[8,10,8,3,3]]],[],[[0,6,3,8,[]],9,9,1]]
[[[],[[9,2,1],4,[]],[6,[4,10,4,3,8],[10,1,4]]],[[[1,5,7,2,0],3,[3,5,5,1],[]],3,[],2]]

[[0,1]]
[[],[[]],[9]]

[[[8,[],[4,5,10,6]],[],[[7],[10],10]],[9,3,[[4,1,0,9],[0,9,8]],[6,0,8],10],[],[]]
[[[[9,9,0,5],1,4,6,[4,9,6,10]]]]

[[[1],[3,10,[3,6]],[5]],[[[],[10],[7,9,5],[],0],4,[[],10,[],2],10,[[7,1,9],7,[0,6,8],[10,4,6,9],[0]]]]
[[[],[[],[10,9,8],[3,6,1,0],[0]],[8],[[],[8,8,7]]],[[]],[]]

[[0],[[[],10,6,9,[7,8]],2,[]],[[[8,3],[6,4],[],[5,9,5,5],[2,10]],[7,4,[],8,[9,5,10]],5,[5,[6]],[]],[3,6,[[10,0,0,10],9],2,1]]
[[0,[9,[1,0],[0,3,4,10],4,[8,1,1,8]]],[[[9,1],[0,5],[2,3,0,7]],[8,[10,9,9,4]],[[]]]]

[[[[10],4],0,9,7,7]]
[[],[[10,2,[2,2,2],5],1],[[[3],[7,3,9],9],1]]

[[3,2,[[7]],2],[6,1,7,[5,[6],2,9]],[[0,[6]],[[0,4,1,7,0],[8,4,9,7,8],[],8,[3]],1],[],[]]
[[1]]

[[],[[[8,5,0,6],3],[[],[3,10],[7,1,1,9,6]]],[],[[[5,9],[2,7],[4],10,6],[7,[0,7,10,9,1],[3,0,9,2,10],8,[6,4]]],[[6,[],[0,3,8,0],2,9]]]
[[[[7]],0,2,10,[[10,2,9]]],[1,[[],10,[8],0,[5,3,8,9,1]],[10,8,[0,9,3],1],2,[4,9]],[],[3,[[9,3,5,4],[],3,[2],[4,6]]]]

[[7,5],[],[8,[[7,9,0,2,9],10,[0,8],[1,6]],5,2],[4,10,8,3],[6,8,[[8,5,7,5,1],[],[5,8]]]]
[[],[[],[],[4,[8,9,5,8,1]],5],[[[6,4,10],[7,4,7,0]],10,1,[[0,8],5],[10,[1,1,8],2,[4,4,1],6]],[]]

[[[[2,4],[9,4,8],10,5],2],[2,[[4,6,7,1],6,4,[10,8,4,2],10]],[],[[[5,0]],[[],0,[1,8,8,9,3]],9,[[10,9,2,6]]]]
[[3,2]]

[[[0,[10,1]],[[],[4,8,8,8,9]],7,[2,0,[2,6]]],[],[3,9,3],[[4],2,[[1,3,9,5,10],[6,0,5],0],[6],[2,0,[]]]]
[[0,9]]

[[10,9,[[0,10],[]],10,2],[3,2,[7,[7,4,7]],[9,[1,10],1,[7,8],[7,7,3,9,2]],8],[[[9,6,1],7,2],10],[],[[2,6,[5,0,3,7],[8,4],1],[5],[3,[8,8,1,6,1]]]]
[[8,[1,[10]],10,[10,[],1,3],[6,3,1]],[[],5,[0,3,[9],[0,4],[3,5,10,2]]],[4],[[[1],4,[6,7],0],[[],2,[9,8,0,5]]],[[[0,4],1,[6,0,6,8],[3,1,0,6],7],[10,[7,6,1,0,10],4,[9,7,1,7,0],[]],8,1,5]]

[[[[],[],[10,1],[1],[3]],[[5,5,4,3],6]],[2],[[[10,9,2,6],[4,2],1,[5,10,8,3]]],[]]
[[[[5]],[6,[5,8]],[[2,10,6,10,2],2]],[[[5,2],4],[7,[9,10,6,8],[],10],[[4,6,4,9,1],[1,8],5,6,[7,8,0,4,7]],[],[4,7,[6,10],[4,10],[9,0,2,6,2]]]]

[[],[7,[[9,10,9],0,[]]],[2,[[3,0,10,7],8,4,5],1,10,[]],[[4,1,7],[[],[],[5],[9]],[0,5,[5,1],4,[]],[[],10,1,10]],[5,[4]]]
[[[5,0],[2,0,[],[10,6,3,0,2],[1,2,7,9]],10,0],[[[5,4],6,3],5,3,[[6,10,8,7,8],[7,6,0,3]]]]

[[10,[6,[],[3],4,[7,4,0]],[[],[2,1,1]],5,5],[8,2,8,4],[[1,2,[3,3]],[[],[10,2,8]]],[2,[],2,[5,[]],7]]
[[[[7]],2,1,[1,1,[7]]],[[7,[],[3,3,10]],[6,3,[2,0,10],[3,1,10],5],3,10],[6,9],[[[9,5],[1,8,8,7,2],10],[9,[5,3,9],[9,2,4,6]],[7,[6,9,9,0],7],10,[10,[],6]]]

[[]]
[[],[[10,[],[10,8,1],[0]]],[1],[[]],[[[4],[7,2]]]]

[[[]],[7,[[10,4]],[],[8]],[[6],[[4,7],9],[7,1,7,[7,1]],8,5]]
[[5,9],[[],6,10,1,3],[3,[8,2,[],[],[0]],7,5,5]]

[[[7,10,0,[3],[]],[]],[[[3,9],[]],[[2,3,7,4]],3,[8,1,[6,6,9],[6,7,6,9,5]]],[[[5,3],9,[],3,9],[9,7],[[],[1],[],8,10],9]]
[[6],[[[8,8,10,4,5],4,[2,5,7,2],0,[1,6]],0,[[0],3,[3,10,7,4,7],8,[5,3,2,3]],8]]

[[0,[],10],[[[4,10,3,10,8],6,9,[9,8,1,4],[0]]],[[[0],[]],9,[[2,10],6]],[]]
[[10,1,[[4,8,2,10]],10],[[],[],10,[]],[[[0],[5,1],1]]]

[[],[7,[[],[3,3,1],7,[2,4,10],[]],5,6],[2],[2,1],[]]
[[[],10,7,5,6],[],[[[7,1,10],6,2,[4],4],4,[[0,4,2]]]]

[[4,[8,6],2,4],[[[9],[10,8],10]],[[[8],5,[9,7,3,1,1]],[3,9],[10,3,[],10,5]],[8]]
[]

[[[[1],[9,6],[8,0,7,9,1],[2,2,0,7]],[[7,5,0,9],8,7,[]]],[],[[[4,6,8,5,6],[],[]],[4,[8,5,6,3],5],[7,[],2,0],9],[2,9,[[0],[1],[5],[8]],8]]
[[9,[[],2],1],[],[2,8,[10,8,0],6,3]]

[[[[1,6,3,10]],4,0,4],[],[0,[],5],[],[[[2,10,8],[4,2,4,10,2],1],4,[[4,2,1,0]]]]
[[[],[],[[0,5,1],5,[0,4,1,3],[9,7,1]],3,10],[[[0]]],[1]]

[[5],[[3,10,[7,10,0],5],4],[2,[[8,10,0]],[[9,0,4],6],[]],[6,10,2,0,2]]
[[[0,9,[7,10,9],[6],6],8,[1,[],[],[9,5,5],4],[6,[9,6,6,7]]]]

[[1,8,4,2],[10,8,[9,[8,4,1,1,8],10]],[],[2,9,[5,[1,5,3],[9,3,5],8,[]],8]]
[[6,5],[[[4,6,10,5,9],10,[10,7],5],[[8],[3,0,7,8],[10,8,5,7],[7,6,4],4],[5,10,[],6]],[7],[]]

[[[[4,10,8,5],[0],8,[0],9]]]
[[8,0,[[5,0,6,3,10]],7],[9],[[],3,0,10]]

[[],[6]]
[[8,1]]

[[],[9,4]]
[[],[[5,4,1],7],[[],4],[],[3,1,[[1],3,4,2]]]

[[[[8],[6,0],0,1],4,[3,[6],1],1,1],[[[2],[3],[]],[[1,6,6,8],8,[8,6,7],[1],10],4,1,7],[[2,[4],[8],10,[10,2,7,1,9]],3,6,[4,3,[1,10,8]],[]],[[1,[9,9]],10],[8,2,[4,[8,10,5,5,2],0,[8,7,0,9]]]]
[[[[9,8],[2,9,8,6,6]],[],[6,[0],[8,10]],5,2]]

[[[1,5,[3,1],1]],[],[[9],1],[[[5,10],[]],[0,9,0]]]
[[[9,[8,6,7,0,8],9,[4,5,3],[10,0,5]],10,[]],[]]`;

const dividerPackets = [[[2]], [[6]]];


let logging = false;

const log = (...m) => logging && console.log(...m);

const parseSignal = (signal) => {
    signal = Array.from(signal.slice(1, signal.length - 1));
    //console.log(signal);
    let result = [];
    let parents = [result];
    let targetElement = result;
    while (signal.length) {
        let ch = signal.shift();

        if (signal.length && ch.match(/\d/) && signal[0].match(/\d/))
            ch += signal.shift();

        if (ch.match(/\d+/)) {
            console.log('trying to parse', ch);
            targetElement.push(parseInt(ch));
        }
        if (ch.match(/\[/)) {
            let arr = [];
            targetElement.push(arr);
            parents.push(targetElement);
            log('new array: depth ', parents.length);
            targetElement = arr;
        }
        if (ch.match(/\]/)) {
            targetElement = parents.pop();
        }

    }

    return result;
};

const parseInput = (input) => {
    let signals = input.split('\n\n').map(s => s.split('\n'));
    let output = [];
    for (let pair of signals) {
        // console.log('Signal 1:');
        // console.log('   1:  ', parseSignal(pair[0]));
        // console.log('   2:  ', parseSignal(pair[1]));
        output.push([parseSignal(pair[0]), parseSignal(pair[1])]);
    }
    return output;
};

const toStr = (arr = '') => {
    if (!Array.isArray(arr)) return arr ?? 'undefined';
    let msg = '[';

    for (let i = 0; i < arr.length; i++) {
        if (Array.isArray(arr[i])) {
            msg += toStr(arr[i]);
        }
        else msg += arr[i];
        if (i < arr.length - 1) msg += ', ';
    }
    msg += ']';
    return msg;
};

const compare = (s1, s2) => {

    while (true) {
        let ch1 = s1.shift();
        let ch2 = s2.shift();
        log('\ncomparing element:\n    ', ch1 ? toStr(ch1) : ch1, '\nto\n    ', ch2 ? toStr(ch2) : ch2, '\n');
        // for (let i = 0; i < 1000000000; i++);
        let result = null;

        if (ch1 == null && ch2 == null) {
            log('  > equal length - jumping out');
            return null;
        }
        else if (ch1 != null && ch2 == null) {
            log('  > right is out first');
            result = false;
        }
        else if (ch1 == null && ch2 != null) {
            log('  > left is out first');
            result = true;
        }
        else if (Array.isArray(ch1) && !Array.isArray(ch2)) {
            log('  > only left is an array');
            result = compare(ch1, [ch2]);
        }
        else if (!Array.isArray(ch1) && Array.isArray(ch2)) {
            log('  > only right is an array');
            result = compare([ch1], ch2);
        }
        else if (Array.isArray(ch1) && Array.isArray(ch2)) {
            log('  > both elements are arrays');
            result = compare(ch1, ch2);
        }
        else if (ch1 > ch2) {
            log('  > right is smaller');
            result = false;
        }
        else if (ch1 < ch2) {
            log('  > left is smaller');
            result = true;
        }


        if (result != null) {
            log('returning ', result);
            return result;
        }
    }
};


const clone = (arr) => {
    let cln = [];

    for (let i = 0; i < arr.length; i++) {
        if (Array.isArray(arr[i])) {
            cln.push(clone(arr[i]));
        }
        else cln.push(arr[i]);
    }
    return cln;
};

const keypress = async () => {
    process.stdin.setRawMode(true);
    return new Promise(resolve => process.stdin.once('data', () => {
        process.stdin.setRawMode(false);
        resolve();

    }));
};

let expectedTestDataResult = [true, true, false, true, false, true, false, false];

const findGoodSignals = async (signals) => {
    console.log('comparing', signals.length, 'signals');
    let d = signals.length;
    let goodIndexes = [];
    for (let i = 0; i < d; i++) {
        // i = 2;

        let s1 = clone(signals[i][0]);
        let s2 = clone(signals[i][1]);
        log('\ncomparing signals:\n    ', toStr(s1), '\nto\n    ', toStr(s2));
        let res = compare(s1, s2);

        res && goodIndexes.push(i + 1);
        logging && await keypress();
    }
    return goodIndexes;
};


(() => {
    exec(async () => {
        logging = false;
        let signals = parseInput(rawinput);
        // Part 1
        let output = await findGoodSignals(signals);
        console.log('part 1:', output.reduce((acc, i) => acc + i, 0));

        // Part 2
        signals = signals.reduce((acc, i) => {
            acc.push(i[0]);
            acc.push(i[1]);
            return acc;
        }, []);
        signals.push(...dividerPackets);

        signals = signals.sort((a, b) => {
            if (compare(clone(a), clone(b))) return -1;
            else return 1;
        });

        let score = signals.reduce((acc, i, index) => {
            if (i == dividerPackets[0] || i == dividerPackets[1]) {
                acc *= (index + 1);
            }
            return acc;
        }, 1);

        console.log('part 2:', score);

    });
})();